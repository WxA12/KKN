<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Album Nostalgia KKN — Versi Light</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    :root{
      --accent:#ff6b6b;
      --bg:#f7fbff;
      --card:#ffffff;
      --muted:#6b7280;
      --radius:12px;
      --shadow: 0 8px 24px rgba(15,23,42,0.06);
    }
    html,body{height:100%}
    body{
      margin:0;
      background:linear-gradient(180deg,var(--bg) 0%, #ffffff 100%);
      color:#0b1320;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      -webkit-font-smoothing:antialiased;
    }

    /* Header */
    .topbar{
      padding:1rem 1rem;
      display:flex;
      align-items:center;
      gap:1rem;
      background:linear-gradient(90deg, rgba(255,255,255,0.8), transparent);
      border-bottom:1px solid rgba(15,23,42,0.04);
      position:sticky;top:0;z-index:50;
      backdrop-filter: blur(4px);
    }
    .brand {display:flex;align-items:center;gap:.7rem}
    .logo{
      width:46px;height:46px;border-radius:10px;background:linear-gradient(135deg,#ffd6d6,#ffb3b3);
      display:flex;align-items:center;justify-content:center;font-weight:700;color:#b02a2a;
    }
    .title{font-weight:700;font-size:1.05rem}
    .subtitle{font-size:.88rem;color:var(--muted)}

    /* Layout */
    .wrap{display:flex;gap:20px;padding:1.25rem;max-width:1200px;margin:1.25rem auto}
    .left{flex:1;min-width:260px}
    .right{width:360px;flex-shrink:0}

    /* Masonry */
    .masonry{column-count:3;column-gap:14px}
    .masonry .card-photo{display:inline-block;width:100%;margin:0 0 14px;border-radius:var(--radius);overflow:hidden;background:var(--card);transition:transform .18s ease,box-shadow .18s ease;box-shadow:var(--shadow)}
    @media (max-width:1100px){ .masonry{column-count:2} }
    @media (max-width:700px){ .wrap{flex-direction:column;padding:1rem} .right{width:auto} .masonry{column-count:1} }

    .card-photo img{width:100%;height:auto;display:block}
    .card-overlay{
      position:relative;padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0), rgba(255,255,255,0.9));
      color:#0b1320;
    }
    .meta{font-size:.82rem;color:var(--muted);margin-top:6px}

    .card-photo:hover{transform:translateY(-6px);box-shadow:0 26px 60px rgba(15,23,42,0.08)}

    /* Badge + controls */
    .controls{display:flex;gap:.6rem;align-items:center}
    .chip{background:rgba(255,107,107,0.06);padding:.35rem .7rem;border-radius:999px;color:var(--accent);font-size:.86rem;border:1px solid rgba(255,107,107,0.08)}

    /* Right panel detail */
    .detail{
      position:sticky;top:84px;padding:1rem;background:linear-gradient(180deg,#ffffff, #fbfdff);
      border-radius:12px;border:1px solid rgba(15,23,42,0.04);
      min-height:220px;box-shadow:var(--shadow);
    }
    .detail .thumb{width:100%;height:160px;object-fit:cover;border-radius:10px;background:#f1f5f9}
    .detail h5{margin-top:.6rem;margin-bottom:.2rem}
    .detail .small{color:var(--muted);font-size:.88rem}

    /* Lightbox mini */
    .lb{
      position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,.45);z-index:2000;padding:20px;
    }
    .lb.open{display:flex}
    .lb-inner{max-width:1100px;width:100%;display:flex;gap:14px;align-items:center}
    .lb-main{flex:1;background:#fff;border-radius:12px;padding:14px;display:flex;align-items:center;justify-content:center;box-shadow:var(--shadow)}
    .lb-main img{max-width:100%;max-height:78vh;border-radius:10px}
    .lb-thumbs{width:120px;display:flex;flex-direction:column;gap:8px;overflow:auto;height:78vh}
    .lb-thumbs img{width:100%;height:72px;object-fit:cover;border-radius:8px;opacity:.85;cursor:pointer;border:2px solid transparent}
    .lb-thumbs img.active{opacity:1;border-color:var(--accent)}

    /* small helpers */
    .muted{color:var(--muted)}
    .btn-accent{background:var(--accent);border:0;color:#fff}
    .tag-pill{display:inline-block;padding:.28rem .5rem;border-radius:999px;background:rgba(255,107,107,0.06);color:var(--accent);font-size:.82rem;border:1px solid rgba(255,107,107,0.06)}
  </style>
</head>
<body>

  <div class="topbar">
    <div class="brand">
      <div class="logo">K</div>
      <div>
        <div class="title">Album Nostalgia KKN</div>
        <div class="subtitle">Dokumentasi lapangan — kenangan tim & warga</div>
      </div>
    </div>

    <div class="ms-auto controls">
      <div class="chip">Desa SukaMaju</div>
      <div class="chip">Periode 2025</div>
      <button id="btnAdd" class="btn btn-sm btn-outline-secondary">Tambah Foto</button>
      <button id="btnUse" class="btn btn-sm btn-accent">Pakai Template</button>
    </div>
  </div>

  <div class="wrap">
    <div class="left">
      <div class="mb-3 d-flex justify-content-between align-items-center">
        <div class="d-flex gap-2">
          <input id="q" class="form-control form-control-sm" style="width:260px" placeholder="Cari judul atau lokasi">
          <select id="selectTag" class="form-select form-select-sm" style="width:160px">
            <option value="">Semua Kategori</option>
            <option>Pelayanan</option>
            <option>Sosialisasi</option>
            <option>Workshop</option>
            <option>Publikasi</option>
          </select>
        </div>
        <div class="muted small">Total foto: <strong id="count">0</strong></div>
      </div>

      <div id="masonry" class="masonry">
        <!-- cards injected by JS -->
      </div>
    </div>

    <aside class="right">
      <div class="detail" id="detailPane">
        <div class="text-center muted">Klik foto untuk melihat detail</div>
      </div>
    </aside>
  </div>

  <!-- Lightbox -->
  <div id="lb" class="lb" role="dialog" aria-hidden="true">
    <div class="lb-inner">
      <div class="lb-main">
        <img id="lbImg" src="" alt="">
      </div>
      <div class="lb-thumbs" id="lbThumbs"></div>
    </div>
  </div>

  <script>
    // Data foto contoh (ganti dengan koleksi KKN nyata)
    const PHOTOS = [
      {id:1, src:'https://images.unsplash.com/photo-1504198453319-5ce911bafcde?q=80&w=1200&auto=format&fit=crop&s=1', title:'Pembukaan Kegiatan', place:'Balai Desa', date:'12 Mar 2025', tag:'Sosialisasi', desc:'Upacara pembukaan dan sambutan kepala desa.'},
      {id:2, src:'https://images.unsplash.com/photo-1524504388940-b1c1722653e1?q=80&w=1200&auto=format&fit=crop&s=1', title:'Survey Lokasi', place:'Dusun Melati', date:'13 Mar 2025', tag:'Pelayanan', desc:'Pengamatan titik kerja dan kebutuhan warga.'},
      {id:3, src:'https://images.unsplash.com/photo-1495567720989-cebdbdd97913?q=80&w=1200&auto=format&fit=crop&s=1', title:'Workshop Literasi', place:'SD Negeri 02', date:'15 Mar 2025', tag:'Workshop', desc:'Pelatihan membaca untuk anak-anak dan pelatihan guru lokal.'},
      {id:4, src:'https://images.unsplash.com/photo-1502741126161-b048400dcb6e?q=80&w=1200&auto=format&fit=crop&s=1', title:'Aksi Bersih Desa', place:'Jalan Utama', date:'17 Mar 2025', tag:'Pelayanan', desc:'Kegiatan kerja bakti membersihkan fasilitas umum.'},
      {id:5, src:'https://images.unsplash.com/photo-1519681393784-d120267933ba?q=80&w=1200&auto=format&fit=crop&s=1', title:'Dokumentasi Hasil', place:'Posko KKN', date:'21 Mar 2025', tag:'Publikasi', desc:'Menyusun dokumentasi untuk laporan akhir.'},
      {id:6, src:'https://images.unsplash.com/photo-1498050108023-c5249f4df085?q=80&w=1200&auto=format&fit=crop&s=1', title:'Penutupan & Refleksi', place:'Balai Desa', date:'25 Mar 2025', tag:'Sosialisasi', desc:'Sesi refleksi dan penyerahan hasil kepada warga.'}
    ];

    const masonry = document.getElementById('masonry');
    const detail = document.getElementById('detailPane');
    const q = document.getElementById('q');
    const selectTag = document.getElementById('selectTag');
    const countEl = document.getElementById('count');
    const lb = document.getElementById('lb');
    const lbImg = document.getElementById('lbImg');
    const lbThumbs = document.getElementById('lbThumbs');

    let visible = PHOTOS.slice();

    function render(){
      masonry.innerHTML = '';
      visible.forEach(p => {
        const card = document.createElement('div');
        card.className = 'card-photo';
        card.innerHTML = `
          <img loading="lazy" src="${p.src}" alt="${escape(p.title)}">
          <div class="card-overlay">
            <div style="display:flex;justify-content:space-between;align-items:flex-start">
              <div>
                <div style="font-weight:700">${escape(p.title)}</div>
                <div class="meta">${escape(p.place)} · ${escape(p.date)}</div>
              </div>
              <div class="tag-pill">${escape(p.tag)}</div>
            </div>
          </div>
        `;
        card.addEventListener('click', () => showDetail(p));
        masonry.appendChild(card);
      });
      countEl.textContent = visible.length;
    }

    function showDetail(p){
      detail.innerHTML = `
        <img class="thumb" src="${p.src}" alt="${escape(p.title)}">
        <h5>${escape(p.title)}</h5>
        <div class="small muted">${escape(p.place)} · ${escape(p.date)}</div>
        <p class="mt-2">${escape(p.desc)}</p>
        <div class="d-flex gap-2 mt-3">
          <button class="btn btn-sm btn-accent" onclick="openLightbox(${p.id})">Lihat Besar</button>
          <button class="btn btn-sm btn-outline-secondary" onclick="download('${p.src}','${sanitizeFilename(p.title)}')">Unduh</button>
          <button class="btn btn-sm btn-outline-secondary" onclick="share('${p.id}')">Bagikan</button>
        </div>
      `;
    }

    // Lightbox
    function openLightbox(id){
      lb.classList.add('open');
      const idx = visible.findIndex(x=>x.id===id);
      if(idx===-1) return;
      setLightboxIndex(idx);
      renderThumbs();
    }
    function closeLightbox(){ lb.classList.remove('open'); }
    lb.addEventListener('click', (e)=>{ if(e.target===lb) closeLightbox(); });

    let lbIndex = 0;
    function setLightboxIndex(i){
      lbIndex = (i+visible.length)%visible.length;
      lbImg.src = visible[lbIndex].src;
      highlightThumbActive();
    }
    function renderThumbs(){
      lbThumbs.innerHTML = '';
      visible.forEach((p,i)=>{
        const img = document.createElement('img');
        img.src = p.src;
        img.alt = p.title;
        img.addEventListener('click', ()=> setLightboxIndex(i));
        lbThumbs.appendChild(img);
      });
      highlightThumbActive();
    }
    function highlightThumbActive(){
      Array.from(lbThumbs.children).forEach((n, i) => {
        n.classList.toggle('active', i===lbIndex);
      });
    }

    // keyboard nav
    document.addEventListener('keydown', (e)=>{
      if(!lb.classList.contains('open')) return;
      if(e.key==='ArrowRight'){ setLightboxIndex(lbIndex+1); }
      if(e.key==='ArrowLeft'){ setLightboxIndex(lbIndex-1); }
      if(e.key==='Escape'){ closeLightbox(); }
    });

    // Filters & search
    function applyFilter(){
      const term = q.value.trim().toLowerCase();
      const tag = selectTag.value;
      visible = PHOTOS.filter(p => {
        const okTag = !tag || p.tag === tag;
        const okTerm = !term || (p.title+ ' ' + p.place + ' ' + p.date + ' ' + p.desc).toLowerCase().includes(term);
        return okTag && okTerm;
      });
      render();
      detail.innerHTML = '<div class="text-center muted">Klik foto untuk melihat detail</div>';
    }
    q.addEventListener('input', debounce(applyFilter, 180));
    selectTag.addEventListener('change', applyFilter);

    // download/share
    function download(url, filename){
      fetch(url).then(r=>r.blob()).then(blob=>{
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = filename;
        document.body.appendChild(link);
        link.click();
        link.remove();
      }).catch(()=>alert('Gagal mengunduh'));
    }
    function share(id){
      const p = PHOTOS.find(x=>x.id===id);
      if(navigator.share){
        navigator.share({title:p.title,text:p.desc,url:p.src}).catch(()=>{});
      } else {
        prompt('Salin tautan foto', p.src);
      }
    }

    function sanitizeFilename(s){ return s.replace(/[^\w\d\-]/g,'_') + '.jpg'; }
    function escape(s){ return String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }
    function debounce(fn, t){ let tm; return (...a)=>{ clearTimeout(tm); tm = setTimeout(()=>fn(...a), t); }; }

    // init
    render();

    // buttons
    document.getElementById('btnUse').addEventListener('click', ()=> alert('Template Album Nostalgia (Versi Terang) dipilih'));
    document.getElementById('btnAdd').addEventListener('click', ()=> alert('Fitur upload belum aktif di demo'));

  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
